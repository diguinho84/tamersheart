<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css"/>
</head>

<script>

    //variaveis
    var canvasHeight;
    var canvasWidth;
    var ctx;

    var coordX = 0;
    var coordY = 0;
    var moveDireita = 0;
    var moveEsquerda = 0;
    var player = 0;

    var teclaPressionada;
    var teclaLiberada;

    var notificaDown;
    var notificaDown;



    //classes
    class Quadrado {

      constructor(x, y, width, height){
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
      }
      
      moveX(dist, intensidade){
        this.x = this.x + dist * (intensidade ? intensidade : 1);
      }
    
    }


//#region Desenho
  function desenhaQuadrado(obj){

      ctx.fillStyle = "#aaaaaa";
      ctx.fillRect(obj.x, obj.y, obj.width, obj.height);
  }
  
  function desenha(obj){

      ctx.fillStyle = "#aaaaaa";
      ctx.fillRect( obj.x, obj.y, obj.width, obj.height);
  }
  
  function limpaTela(){

    ctx.clearRect(0, 0, canvasWidth, canvasHeight);
  }
  
  function draw() {

    movimentacaoLogica(player);

    limpaTela(); 
    desenha(player);

    window.requestAnimationFrame(draw);
  }
//#endregion




//#region Init Settings
function initCanvasContextSettings(){

    canvasHeight = document.getElementById("canvas").getAttribute("height");
    canvasWidth = document.getElementById("canvas").getAttribute("width");
    ctx = document.getElementById("canvas").getContext("2d");
}

function init(){

  //varaives padrao canvas
  initCanvasContextSettings();

  //inicializa o player, talvez os demais elementos e players
  player = new Quadrado(10, 10, 10, 10);

  //starta o loop de animacao
  window.requestAnimationFrame(draw);
}
//#endregion




//#region Movimentacao logica
//sao dois sinais apenas por enquanto, down e up
function setaVetoresDirecao(player, e){

  //Seta os vetores direcao
  //Como s√≥ tem keydown ou keyup deu pra fazer o ternario
  if( e.key == "ArrowRight") {  moveDireita  = e.type == "keydown" ?  1 : 0;}
  if( e.key == "ArrowLeft")  {  moveEsquerda = e.type == "keydown" ?  1 : 0;}
}

function movimentacaoLogica(player){

  //Aplica os vetores direcao
  moveDireita  == 1 ? player.moveX(1,1)  : true ;
  moveEsquerda == 1 ? player.moveX(-1,1) : true ;  
}
//#endregion




//#region Event Listenners e Notificacoes
  document.addEventListener("keydown", function(event) {notifica(event);});
  document.addEventListener("keyup", function(event)   {notifica(event);});
  window.addEventListener('load', init);

  function notifica(e){

    if(e.type == "keydown"){ setaVetoresDirecao(player, e)}
    if(e.type == "keyup")  { setaVetoresDirecao(player, e)}

  }
//#endregion




</script>





<script>
    // ok - colocar alguns objs e possivelmente uma classe

    //facilitar o desenvolvimento
    //movimentacao simples, colocar pra Y e adequar classes, colisao simples
    //revisar o codigo, comentar codigo, colcar eixoY, e colisao quadratica
    //contexto de colisao quadratica
    //colocar td no js
    //nao vai ter desempenho maximo nem rodar em td por hora
    //ver classes pra ja colocar
    //colocar contexto de posicionamento e colisao
    //contexto de bitmap
    //alguma animacao de ataque
    //se conseguir duas animacoes de atq versionar
    //rn - precisa tirar nota em provas escrita e pratia pra ir ranked
    // const element = document.querySelector("textarea"),
    //   ArrowRight = k => {
    //      console.log(k);
    //   },
    //   ArrowLeft = k => {
    //      console.log(k);
    //   },
    //   ArrowUp = k => {
    //      console.log(k);
    //   },
    //   ArrowDown = k => {
    //      console.log(k);
    //   },
    //   handler = {
    //      ArrowRight,
    //      ArrowLeft,
    //      ArrowUp,
    //      ArrowDown
    //   };
    //   element.addEventListener("keydown", e => {
    //      const k = e.key;
    //      if (handler.hasOwnProperty(k)) {
    //         handler[k](k);
    //      }
    //   });

    //nao funciona pois os valores estao no atributo inves do style
    //canvasHeight = document.getElementById("canvas").style.height;
    //canvasWidth = document.getElementById("canvas").style.width;

</script>



















<body>

    <p style="text-align: center;">uia</p>

    <div style="text-align: center">
        <canvas id="canvas" width="200" height="500" 
          style="border: 1px solid #c9c9c9;">
        </canvas>
    </div>


</body>
</html>



